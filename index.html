

<!DOCTYPE html>
<head>
 

<link rel='stylesheet' href='https://tafengtravel.github.io/tafengtravel/index/css/smart.css' type='text/css'>
<link href="https://tafengtravel.github.io/tafengtravel/index/index.css" rel="stylesheet" >

<link rel="stylesheet" href="https://tafengtravel.github.io/tafengtravel/index/index.css">

<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">

<link href='https://tafengtravel.github.io/tafengtravel/index/sm-css/sm-core-css.css' rel='stylesheet' type='text/css' />
<!-- "sm-blue" menu theme (optional, you can use your own CSS, too) -->
<link href='https://tafengtravel.github.io/tafengtravel/index/sm-css/sm-mint/sm-mint.css' rel='stylesheet' type='text/css' />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css">

<script src="https://tafengtravel.github.io/tafengtravel/index/js/jquery.min.js.js"></script>     
<script src="https://tafengtravel.github.io/tafengtravel/index/js/slick.js"></script>
<script src="https://tafengtravel.github.io/tafengtravel/index/js/aos.js"></script>
<script src="https://tafengtravel.github.io/tafengtravel/index/js/smart-app-banner.js"></script>    
<script src="https://tafengtravel.github.io/tafengtravel/index/js/mobile-detect.js"></script>

<script src="https://tafengtravel.github.io/tafengtravel/index/js/functions.js"></script>
<script src="https://tafengtravel.github.io/tafengtravel/index/js/controller.js"></script>
<script src="https://tafengtravel.github.io/tafengtravel/index/js/swiper.jquery.min.js"></script>

<script src="https://tafengtravel.github.io/tafengtravel/index/js/jquery.smartmenus.js"></script>
<script src="https://cdn.rawgit.com/SSENSE/vue-carousel/6823411d/dist/vue-carousel.min.js"></script>


<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<link href="https://tafengtravel.github.io/tafengtravel/index/css/elementUI.css" rel="stylesheet" />
<link href="https://tafengtravel.github.io/tafengtravel/index/css/common.css" rel="stylesheet" />
<link href="https://tafengtravel.github.io/tafengtravel/index/css/swiper.min.css" rel="stylesheet" />

<link href="https://tafengtravel.github.io/tafengtravel/index/css/book.css" rel="stylesheet" />

<link rel="canonical" id="canonical" href="" />


<!--自家檔案-->

<link rel="icon" href="https://tafengtravel.github.io/tafengtravel/index1/tafenglogo6.ico" type="image/x-icon" />
<link rel="shortcut icon" href="https://tafengtravel.github.io/tafengtravel/index1/tafenglogo6.ico" type="image/x-icon" />

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.3.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-firestore.js"></script>


<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyC1DlPU6BqCFXzWLBZ_6Y90KNLwYzfei3c",
    authDomain: "tafengtravel-web.firebaseapp.com",
    projectId: "tafengtravel-web",
    storageBucket: "tafengtravel-web.appspot.com",
    messagingSenderId: "971660802735",
    appId: "1:971660802735:web:af7e22d11fe81ca63ab25a"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
</script>

<!-- axios -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js'></script>



<script src="https://unpkg.com/vue-router@2.0.0/dist/vue-router.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143702269-1"></script>

<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-143702269-1', {
'linker': {
    'domains': ['tafengtravel.github.io', 'tafeng66.com.tw']
}
});
</script>

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '708390289347362');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=708390289347362&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Facebook Event -->


<!-- GA Event -->
<script>
window.addEventListener('load', function(event) {
document.querySelectorAll("[href^='http://line.me']").forEach(function(item){
    item.addEventListener('click', function(event){
        gtag("event", "點擊", {event_category: "line客戶轉換"});
    })
})
document.querySelectorAll("[href^='https://line.me']").forEach(function(item){
    item.addEventListener('click', function(event){
        gtag("event", "點擊", {event_category: "line客戶轉換"});
    })
})
})  
</script>

<style>
@media (min-width: 768px){
    .sm-mint a, .sm-mint a:hover, .sm-mint a:focus, .sm-mint a:active, .sm-mint a.highlighted {
    padding: 19px 20px;
    border-radius: 4px 4px 0 0;
    }
    .sm-mint a.has-submenu {
    padding-right: 34px;
    }

}
@media (max-width: 768px) {
    .table-sm td, .table-sm th{
    padding: 1px;
    } 
}
.font{
    white-space: pre-wrap;
}

</style>

   
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title></title>   	

<meta name="description" content="">
<meta name="keywords" content=""> 
<meta http-equiv="expires" content="0">
<meta http-equiv="cache-control" content="no-cache">  
<meta http-equiv="pragma" content="no-cache">
<meta name="format-detection" content="telephone=no">



</head>
<body id="page_body" class="green-page">

<div class="include" file="https://tafengtravel.github.io/tafengtravel/index/top"></div>
    
<div id="pnl_wrapper" class="wrapper homepage green-page">
 



    <div id="app"> 
      <div v-if ="itemData.title != undefined"> 
        <router-view></router-view>
        <div class ="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-24 el-col-sm-offset-0 el-col-lg-18 el-col-lg-offset-3">
            <div class="el-row">
                <carousel v-bind:autoplay="true" v-bind:loop="true" :per-Page="1">
                
                    <slide v-for="(item, index) in coverCount">
                        <img class="d-none d-md-block" style="width:100%" :src= "itemData.coverUrlBig[index].url">
                        <img class="d-block d-md-none" style="width:100%" :src="itemData.coverUrlSmall[index].url"></a>
                    </slide>
                </carousel>
            </div>
            <!-- <div >
                <span v-for="(item, index) in itemData.coverUrl" class="home-banner">    
                    <a href="#" ><img class="d-none d-md-block" src="https://tafengtravel.github.io/tafengtravel/index/product/penghu/image/penghu_1_cover_1.jpg" alt="#" ><img class="d-block d-md-none" src="https://tafengtravel.github.io/tafengtravel/index/product/penghu/image/penghu_1_cover_1.jpg" alt="#" ></a>
                    <a href="#" ><img class="d-none d-md-block" src="https://tafengtravel.github.io/tafengtravel/index/product/penghu/image/penghu_1_cover_1.jpg" alt="#" ><img class="d-block d-md-none" src="https://tafengtravel.github.io/tafengtravel/index/product/penghu/image/penghu_1_cover_1.jpg" alt="#" ></a>
                </span>
            </div> -->

            <br>
            <div class="el-row">
                <div class="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-24 el-col-sm-offset-0 el-col-lg-16 el-col-lg-offset-0" style="padding-left:12px;padding-right:12px;">
                    <el-row>
                        <font class ="title">{{itemData.title}}</font>
                    </el-row>
                    <el-row>
                        <el-breadcrumb separator-class="el-icon-arrow-right">
                            <el-breadcrumb-item>
                                <font class ="mini_font">
                                    <a :href = "countryUrl">{{itemData.country}}</a>
                                </font>
                            </el-breadcrumb-item>
                            <el-breadcrumb-item>
                                <font class ="mini_font">
                                    <a :href = '"https://tafengtravel.github.io/tafengtravel/index/product/search.html?location="+ itemData.location'>{{itemData.location}}</a>
                                </font>
                            </el-breadcrumb-item>
                        </el-breadcrumb>
                    </el-row>
                    <el-row>
                        <font class ="sub_title">行程特色</font>
                    </el-row>
                    <el-row>
                        <font class ="font">{{itemData.features}}</font>
                    </el-row>
                    
                </div>

                <div class ="hidden-md-and-down border-l border-grey-light el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-24 el-col-sm-offset-0 el-col-lg-8 el-col-lg-offset-0" style="padding-left:12px;padding-right:12px;">
                    <el-row>
                        <span class= "el-col-3">
                            <font class ="font"><i class="el-icon-date"></i></font>
                        </span>            
                        <span class= "el-col-21">
                            <font class ="font">可預訂日期：{{itemData.day}}</font>
                        </span> 
                    </el-row>
                    <el-row>
                        <span class= "el-col-3">
                            <font class ="font"><i class="el-icon-time"></i></font>
                        </span>           
                        <span class= "el-col-21">
                            <font class ="font">出發時間：{{itemData.depTime}}</font>
                        </span>
                    </el-row>
                    <el-row>
                        <span class= "el-col-3">
                            <font class ="font"><i class="el-icon-s-custom"></i></font>
                        </span>            
                        <span class= "el-col-21">
                            <font class ="font">最少預定數：{{itemData.minAmount}}人</font>
                        </span>   
                    </el-row>
                </div>

            </div>

            <el-divider></el-divider>

            <div class="el-row">

                <div class="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-24 el-col-sm-offset-0 el-col-lg-16 el-col-lg-offset-0" style="padding-left:12px;padding-right:12px;">
                    <el-divider></el-divider>
                    <el-row>
                        <font class ="sub_title" id ="choose_link">方案選擇</font>
                    </el-row>

                    <el-row>
                        <font class ="font">行程日期</font>
                        <div class="block">
                            <el-date-picker
                            v-model="datevalue1"
                            type="date"
                            placeholder="選擇日期"
                            id = 'dep_date'
                            :picker-options="pickerOptions"
                            
                            >
                            </el-date-picker>
                        </div>
                    </el-row>

                    <!--1-->

                    

                    <div v-for="(item, index) in itemDetail" >

                        <el-row>
                            
                            <el-card class="box-card">
                                <div class="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-20 el-col-sm-offset-0" id="box-card" style="padding-left:8px;padding-right:8px;">
                                    <font class ="font">{{item.title}}</font><br>
                                    <font class ="mini_font"><i class="el-icon-time"></i><span>&emsp;行程總長：{{item.time}} 小時</span></font><br>

                                </div>
                                <div class="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-4 el-col-sm-offset-0" >
                                    <el-button type="primary is-plain" style="width:100% ;margin:0px 0px 15px 0px" @click="isShow = index+1 ;choose()">選擇</el-button>
                                </div>  
                            </el-card>            

                            <el-card class="box-card " v-if="isShow == index+1">
                                <div class="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-20 el-col-sm-offset-0" id="box-card" style="padding-left:8px;padding-right:8px;">
                                    <el-row>
                                        <!-- <span v-for="(item, index1) in itemRadio[index]" >
                                            <template></template>
                                                <el-radio v-model="radio" label="item.radio0" border @change="radioChange()">{{item}}</el-radio><label>&nbsp;</label>
                                            </template>
                                        </span> -->
                                        <el-radio-group v-model="radio">
                                            <el-radio v-for="(item,index1) in itemRadio[index]" :label="item" @change="radioChange();per_price()" border>
                                                {{item}}
                                            </el-radio>
                                        </el-radio-group>
                                    </el-row>

                                    <el-row>
                                        <font class ="font"><span>場次：</span></font>
                                        <template>
                                            <el-select v-model="depValue" placeholder="請選擇場次" >
                                            <el-option 
                                                v-for="item in depOptions[index]"
                                                :key="item"
                                                :label="item"
                                                :value="item"
                                                >
                                            </el-option>
                                            </el-select>
                                        </template>
                                    </el-row>

                                    <el-row>
                                        <font class ="font"><span>數量：</span></font> 
                                        <template>
                                            <el-input-number v-model="quantity0" :min="1" :max="10" @change="per_price()"></el-input-number>
                                        </template>
                                        <font class ="mini_font">{{itemData.itemOtherAdult[index][0]}}</font>
                                    </el-row>

                                    <el-row v-if="isShowKid[index]">
                                        <font class ="font"><span>數量：</span></font> 
                                        <template>
                                            <el-input-number v-model="quantity1" :min="0" :max="10" @change="per_price()"></el-input-number>
                                        </template>
                                        <font class ="mini_font">{{itemData.itemOtherKid[index][0]}}</font>
                                    </el-row>

                                    <el-row>
                                            <font class ="font"><span>費用：${{price}}</span></font>                             
                                    </el-row>                
                                    
                                </div>
                                <div class="el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-4 el-col-sm-offset-0" >
                                    <el-button type="primary is-plain" style="width:100% ;margin:0px 0px 15px 0px" @click = 'buy()'>立即訂購</el-button>
                                </div>  
                            </el-card>

                        </el-row>

                    </div>

                    


                    <el-divider></el-divider>
                    <el-row>
                        <font class ="sub_title">行程介紹</font>
                    </el-row>

                    <el-row>
                        <font class ="font"><p v-html ="itemData.itinerary"></p></font> 
                    </el-row>

                    <el-divider></el-divider>

                    <el-row>
                        <font class ="sub_title">活動照片</font>
                    </el-row>

                    <div class="el-row">
                        <div class="el-col el-col-xl-16 el-col-lg-16 el-col-md-16 el-col-xs-24 el-col-sm-24 " >
                            <el-row>
                                <el-image 
                                        style="width: 100%"
                                        :src="srcList[0]"
                                        :preview-src-list="srcList"
                                        >
                                </el-image>
                            </el-row> 
                            <el-row>
                                <font class ="font">點擊即可查看更多</font>
                            </el-row>       
                        </div>
                    </div>
                    
                            
                    <el-divider></el-divider>
                    <!--
                    <el-row>
                        <font class ="sub_title">行程說明</font>
                    </el-row>
                    <el-row>
                        <font class ="font"><span id ="features"></span></font>
                    </el-row>
                    <el-divider></el-divider>
                    -->         

                    <el-row>
                        <font class ="sub_title">集合地點</font>
                    </el-row>
                    <el-row>
                        <font class ="font">{{itemData.pickup}}</font>
                    </el-row>

                    <el-divider></el-divider>
                    <el-row>
                        <font class ="sub_title">注意事項</font>
                    </el-row>
                    <el-row>
                        <font class ="font"><p v-html ="itemData.announce"></p></font> 
                    </el-row>

                    <el-divider></el-divider>

                    <el-row>
                        <font class ="sub_title">取消規定</font>
                    </el-row>
                    <el-row>
                        <font class ="font"><p v-html ="itemData.cancel"></p></font> 
                    </el-row>
                                
                </div>

                
                <div class=" hidden-sm-and-down h-auto el-col el-col-24 el-col-xs-24 el-col-xs-offset-0 el-col-sm-24 el-col-sm-offset-0 el-col-md-8 el-col-md-offset-0 el-col-lg-8 el-col-lg-offset-0" >
                    <div class = "position" id="position" style="position: sticky;top: 120px;">
                        <el-card class="box-card" id="cart" style="width: 400px;">

                            <font class ="font"><span>最低售價</span></font>
                            <font class ="box_sub_title" style="margin-left: 140px;">${{itemData.lowPrice}}起</font><br><br>
                            <font class ="mini_font"><span>訂購完成後須等待空位確認，專員會於1個工作天內回覆您預定結果，並將付款連結寄至您的信箱，訂單將於付款後正式成立。</span></font><br>
                            <a href="#choose_link"><el-button type="primary" style="width:100% ;margin-top: 6px;" @click="isShow = index+1 ;choose()" >選擇方案</el-button></a><br>

                        </el-card>
                    </div>


                </div>

                <div class='hidden-sm-up'>
                    <div class="el-col el-col-xs-18 el-col-xs-offset-0 el-col-sm-18 el-col-sm-offset-0" style="padding-left:8px;padding-right:8px;">
                        <font class ="font"><span>最低售價</span></font><br>
                        <font class ="box_sub_title">${{itemData.lowPrice}}起</font>
                    </div>
                    <div class="el-col el-col-xs-6 el-col-xs-offset-0 el-col-sm-6 el-col-sm-offset-0" >
                        <a href="#choose_link"><el-button type="primary" style="width: 100%;margin: 6px 0px 6px -10px;" @click="isShow = index+1 ;choose()">選擇方案</el-button></a>
                    </div>  

                </div>


            </div>
        </div>

        <div class ="el-col el-col-24" style="background-color:#F0F0F0;">

            <div class ="el-col el-col-22 el-col-xs-22 el-col-xs-offset-1 el-col-sm-22 el-col-sm-offset-1 el-col-lg-18 el-col-lg-offset-3">

                <div class="el-row">
                    <br>
                    <div class="sub_title" style="text-align:center">更多行程</div>
                    <br>
                    <el-row :gutter="20">
                        <carousel v-bind:autoplay="true" v-bind:loop="carouselLoop" :per-page-custom=[[480,2],[780,4]] :pagination-enabled='false' >
                            
                            <!-- <slide v-for="(item, index) in coverCount">
                                <img class="d-none d-md-block" style="width:100%" :src= "itemData.coverUrlBig[index].url">
                                <img class="d-block d-md-none" style="width:100%" :src="itemData.coverUrlSmall[index].url"></a>
                            </slide> -->
        
                            <slide v-for="item in itemCarousel" style="background-color:#F0F0F0; height:350px;">
                                <a :href ='"https://tafengtravel.github.io/tafengtravel/index/product/product.html?id="+item.id'>
        
                                    <el-col class ="el-col el-col-24 el-col-xs-24 el-col-sm-24 el-col-md-24 el-col-lg-24 ">
                                        <el-card class="box-card"  :body-style="{ padding: '0px'}"  style="min-height: 370px; " shadow="hover" >
                                            <div class ="image-margin  el-col el-col-24 el-col-xs-24 el-col-sm-24 el-col-md-24 el-col-lg-24 ">
                                                <el-image style="width:100% ;height: 180px" :src="item.coverUrlSmall":fit="fits">
                                                </el-image>
                                            </div>
        
                                            <div  style="padding: 10px;text-align:left" class ="text-margin el-col el-col-24 el-col-xs-24 el-col-sm-24 el-col-md-24 el-col-lg-24"> 
                                                <span class="font"><font color="black">{{item.title}}</font></span>
                                            </div>
        
                                            <!-- <div  style="padding: 10px;" class ="text-margin el-col el-col-24 el-col-xs-24 el-col-sm-24 el-col-md-24 el-col-lg-24"> 
                                                <font class="mini_font">{{item.features}}...</font>
                                            </div> -->
        
                                            <div  style="padding: 10px; text-align:right" class ="text-margin el-col el-col-24 el-col-xs-24 el-col-sm-24 el-col-md-24 el-col-lg-24"> 
                                                <span class="font">$</span> 
                                                <span class="sub_title"><font color="#FF6600">{{item.lowPrice}}</font></span>
                                                <span class="font">起</span> 
                                            </div>
        
                                        </el-card>
                                    </el-col>
        
                                </a>
                            </slide>
                        </carousel>
                    </el-row>
                </div>

            </div>
        </div>
      </div>

        

    </div>
</div>
</div>


<div class="text-center">

    <div class="include" file="https://tafengtravel.github.io/tafengtravel/index/footer"></div>

</div> 



<a class="go-to-top" id="goTop" href="#"><i class="fa fa-caret-up"></i>top</a>

    
</body>

<script type="text/javascript">

//使用jQuery的load方法
$(".include").each(function(){
    if(!!$(this).attr("file")) {
        var $includeObj = $(this);
        $(this).load($(this).attr("file"), function(html){
            $includeObj.after(html).remove();    //載入的檔案內容寫入到當前標籤後面並移除當前標籤
        })
    }
});
</script>

<script src="https://unpkg.com/vue@2.6.12/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui@2.15.0/lib/index.js"></script>

<style>
@media (min-width: 768px){
    .VueCarousel-slide {
        height:350px;
    }
    .VueCarousel-pagination{
        margin-top: -80px; 
        margin-bottom: -30px;
        position: absolute;
    }

}
@media (max-width: 768px) {
    .VueCarousel-slide {
        height:250px;
    }
    .VueCarousel-pagination{
        margin-top: -60px; 
        margin-bottom: -50px;
        position: absolute;
    }
}
    .VueCarousel-slide {
  color:#FFF;
  background:white;
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing:border-box;
  font-size:12px;
  text-align:center;
}

</style>

<script>
    let data 
    let item
    let kidTrue =[]
    let itemCarousel =[]

    const urlParams = new URLSearchParams(window.location.search)
    const paramsObj = Object.fromEntries(urlParams)

    console.log(paramsObj.id)

    var db = firebase.firestore();
    ref = db.collection('product').doc(paramsObj.id);
    
    let type ;//品項內容
    let type2;//判斷 css disable
    let number ;
    let product_length = 1;
    let dateDep 
    let quantity

    Vue.use(VueRouter)

    const ParentComponent = {
        name: 'parent',
        template: '<router-view/>'
    }

    const ChildComponent = {
        name: 'child',
        template: ''
        ,
    }

    let id1 = ''

    const router = new VueRouter({
        mode: 'history',
        base: '/tafengtravel/',
        routes: [
            {
            path: '/',
            name: 'home',
            component: {
                name: 'home',
                template: ''
            },
            },
            {
            path: '/product/:id',
            component: ParentComponent,
            children: [
                {
                path: '',
                name: 'foo',
                component: ChildComponent,
                meta: {
                    title: 'Foo'
                }
                },
                
            ]
            },
            {
            path: '*',
            name: 'e404',
            component: {
                name: 'e404',
                template: '<h1>404 Page Not Found!</h1>'
            }
            }
        ]
        })
    
    var Main = {
        router,
        // template: '<router-view/>',
        components: {
            'carousel': VueCarousel.Carousel,
            'slide': VueCarousel.Slide,
        },
    created () {
        if (sessionStorage.redirect) {
        const redirect = sessionStorage.redirect
        delete sessionStorage.redirect
        console.log(redirect)
        this.$router.push(redirect)
        }
    },
    data() {
        return {
            disabledDate:'',
            pickerOptions: {
                disabledDate(time) {
                    let date = data.dates
                    let disableDateRange = []
                    let disableDateTrue = true

                    if(date === undefined){
                        return time.getTime() < new Date().getTime() + 48*60*60*1000 || time.getTime() > new Date('2021/10/31').getTime() 
                    }

                    for(i=0;i<date.length;i++){
                        disableDateRange[i] = time.getTime() < new Date(date[i]).getTime()-24*60*60*1000 || time.getTime() > new Date(date[i]).getTime()
                    }
                    for(i=0;i<disableDateRange.length-1;i++){
                        disableDateTrue = disableDateRange[i]&&disableDateRange[i+1]&&disableDateTrue
                    }

                    return disableDateTrue || time.getTime() < new Date().getTime()+24*60*60*1000
                }
            },
            datevalue1: new Date().getTime() + 48*60*60*1000,
            depValue: '',
            depOptions: [],
            quantity0: 1,
            quantity1: 0,
            radio: '',
            url: [
                
            ],
            srcList: [

            ],

            itemData:[],
            itemDetail:[],
            itemRadio:[],
            isShow:false,
            isShowKid:[],
            index:0,
            index1:0,
            price:0,
            
            coverUrlBig:[],
            coverUrlSmall:[],
            imageUrl:[],

            coverCount:0,
            itemCarousel:[],
            fits:'cover',
            carouselLoop:true,

            countryUrl:'',
            };
 
        },methods: {
            choose(){
                this.radio = data.itemRadio[this.isShow-1][0]
                this.depValue = this.depOptions[this.isShow-1][0]
                this.per_price()
            },
            per_price(){
                let x=0;let y=0
                let kidPrice = 0;
                for(i=0;i<Object.keys(data.itemRadio).length;i++){
                    for(j=0;j<Object.keys(data.itemRadio[i]).length;j++){
                        if(this.radio == data.itemRadio[i][j]){
                            x=i
                            y=j
                            break;
                        }
                    }
                }
                // console.log(x,y)
                if (data.itemPriceKid[x][y] === undefined || data.itemPriceKid[x][y] == '0' ){
                    kidPrice = 0
                }else{
                    kidPrice = parseInt(data.itemPriceKid[x][y])*this.quantity1
                }
                this.price = parseInt(data.itemPrice[x][y])*this.quantity0 + kidPrice
                // console.log(data.itemPrice[x][y])
                // console.log(this.quantity0)
                // console.log(kidPrice)
                // console.log(this.price )
            },
            radioChange(){
                console.log(this.radio)
            },
            dataArrange(data){

                for(i=0;i<Object.keys(data).length;i++){
                    let jLength = Object.keys(data[i]).length
                    for(j=0;j<jLength;j++){
                        if (data[i][j] == ''){
                            delete data[i][j]
                        }
                    }
                }
                return data
            },
            buy(){
                let date = new Date(this.datevalue1).getFullYear() +'-'+(new Date(this.datevalue1).getMonth()+1)+'-'+new Date(this.datevalue1).getDate()
                console.log(this.itemDetail)
                let URL = 'https://tafengtravel.github.io/tafengtravel/index5/edit.html'

                let urlParams = (new URLSearchParams(
                    {title:this.itemData.title,itinerary: this.itemDetail[this.isShow-1].title,dep_date:date,
                        price:this.price,quantityAdult:this.quantity0,quantityKid:this.quantity1,time:this.depValue,
                        type:this.radio
                })).toString();
                console.log(urlParams)

                let URL2 ='https://tafengtravel.github.io/tafengtravel/index/book/book.html'+'?'+urlParams

                window.location.href= URL2

                // const urlParams1 = new URLSearchParams(urlParams)
                // const paramsObj1 = Object.fromEntries(urlParams1)
            }
        },async mounted(){
            console.log(this.$route.params)

            ref = db.collection('product').doc(this.$route.params.id);

            await ref.onSnapshot(doc => { 
                if(typeof(doc.data()) == 'undefined'){
                    alert('錯誤');
                    return 0;
                }
                data = doc.data()
                console.log(doc.data())

                document.title= data.title+'｜大豐旅行社'
                
                document.getElementById("canonical").href = "https://tafengtravel.github.io/tafengtravel/index/product/product.html?id="+ data.id

                this.itemData = data

                this.itemDetail = Object.keys(data.itemTitle).map(swag=>({title:data.itemTitle[swag],time:data.itemTime[swag]}))
                console.log(this.itemDetail)
                this.itemRadio = data.itemRadio
                
                // this.depOptions = Object.keys(data.itemDepTime).map(swag=>({time:data.itemDepTime[swag]}))
                this.depOptions = data.itemDepTime

                let a = 0

                for(i=0;i<Object.keys(data.itemPriceKid).length;i++){
                    if(data.itemPriceKid[i][0] != 0){
                        this.isShowKid[i] = true
                    }else{
                        this.isShowKid[i] = false
                    }
                }

                data.itemDepTime = this.dataArrange(data.itemDepTime)
                data.itemRadio = this.dataArrange(data.itemRadio)
                data.itemOtherAdult = this.dataArrange(data.itemOtherAdult)
                this.itemData.itemDepTime = data.itemDepTime
                this.itemData.itemRadio = data.itemRadio
                
                this.coverCount = data.coverUrlBig.length

                for(i=0;i<data.imageUrl.length;i++){
                    this.srcList[i] = data.imageUrl[i].url
                }
                this.srcList.reverse()
                this.srcList.reverse()

                ref = db.collection('list')

                if(data.location != ''){
                    this.countryUrl = 'https://tafengtravel.github.io/tafengtravel/index/product/location.html'

                    ref.where('location','==',data.location).get().then(querySnapshot => {
                        let i=0
                        querySnapshot.forEach(doc => { 
                            if(doc.data().available == true && doc.data().id != data.id){
                                itemCarousel[i] = doc.data()
                                itemCarousel[i].features = (doc.data().features).slice(0,20)
                                i = i+1
                            }
                            
                        });  
                        if (i<4){
                            this.carouselLoop = false
                        }
                        this.itemCarousel = itemCarousel
                    });
                }else{
                    this.countryUrl = ''

                    ref.where('country','==',data.country).get().then(querySnapshot => {
                        let i=0
                        querySnapshot.forEach(doc => { 
                            if(doc.data().available == true && doc.data().id != data.id){
                                itemCarousel[i] = doc.data()
                                itemCarousel[i].features = (doc.data().features).slice(0,20)
                                i = i+1
                            }
                            
                        });  
                        if (i<4){
                            this.carouselLoop = false
                        }
                        this.itemCarousel = itemCarousel
                    });

                }
            });

        } 
        
     
    };
    let Today=new Date();
    console.log(Today.getFullYear()+'-'+ (Today.getMonth()+1) +'-'+ Today.getDate())

    var Ctor = Vue.extend(Main)
    new Ctor().$mount('#app')

    document.onscroll = function() {
		var y = window.pageYOffset || document.documentElement.scrollTop;
        
		if (y > 900) {
            document.getElementById("position").style.position = "fixed";
            document.getElementById("cart").style.width = "400px";
		} else {
            document.getElementById("position").style.position = "sticky";
		}

        if(document.documentElement.scrollHeight-document.documentElement.scrollTop-document.documentElement.clientHeight < 250){
            document.getElementById("position").style.position = "sticky";
        }
	};

</script>

</html>
