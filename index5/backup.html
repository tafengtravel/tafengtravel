<html>
   <head> 

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>報帳系統__修改報帳</title>   	
   
    <meta http-equiv="cache-control" content="no-cache">  
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta name="format-detection" content="telephone=no">

   </head>
   <body>
   <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
   <link rel="stylesheet" href="input.css">
   
<style>  
   
</style> 
   
<div class="title"  >大豐旅行社__在地行程備份</div> 


<button onclick="search()" class="lable" id ="search"  type="button" >備份</button>


   <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="/__/firebase/7.14.3/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<!-- Initialize Firebase -->
<script src="/__/firebase/init.js"></script>
   
   <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>

<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase-firestore.js"></script>

<script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js" charset="utf-8"></script>

<style>
.lable {
  font-size: 25px;
  font-family:Microsoft JhengHei;
  font-weight:bold;
}


table {
  font-size: 30px;
  border: none ;
  text-align:center;
  font-family:Microsoft JhengHei;
  font-weight:bold;
  background-color:	#AAFFEE;
  table-layout:fixed;
}
.lable1 {
    font-size: 30px;
    font-weight:bold;
    font-family:Microsoft JhengHei;

}
.lable2 {
    font-size: 35px;
    font-weight:bold;
    font-family:Microsoft JhengHei;

}

.title
{
    font-size: 60px;
    text-align: center;
    font-family:Microsoft JhengHei;
    font-weight:bold;
    width:"100%";    
    background-color:	#AAFFEE;
} 

a{
  color:black; 
  text-decoration:none;
} 
.r1{
  background-color: #D4D4D4;
}
.r2{
  background-color: #FFDA96;
}
.r3{
  background-color: #B9E5FF;
}
.r4{
  background-color: #FFD8D3;
}
.r5{
  background-color: #DBFFD1;
}
.r6{
  background-color: #D4D4D4;
}
.status{
  float:right;  
}
.r7{
  background-color: #BEBEBE	;
}
.lableop{
  font-size: 28px;
  font-family:Microsoft JhengHei;
  color:rgb(12, 9, 177);
  font-weight:bold;
}
.lablecheck{
  font-size: 28px;
  font-family:Microsoft JhengHei;
  color:#8F0000;
  font-weight:bold;
}.lablemanager{
  font-size: 28px;
  font-family:Microsoft JhengHei;
  color:rgb(248, 8, 248);
  font-weight:bold;
}
html,body{
  font-family:Verdana,sans-serif;
  font-size:15px;
  line-height:1.2
  }
@media(max-width:768px) {
      
      .title{
        font-size: 20px;
      } 
      table  {
        font-size: 10px;
        border: none ;
        text-align:center;
        font-family:Microsoft JhengHei;
        font-weight:bold;
      } 
  
  }

  
  .table1 {
      font-size: 30px;
  }
  .lable {
      font-size: 20px;
      font-family:Microsoft JhengHei;
      font-weight:bold;
  }
  
  
  .lable1 {
      font-size: 30px;
      font-weight:bold;
      font-family:Microsoft JhengHei;
  
  }
  
  .title
  {
      font-size: 60px;
      text-align: center;
      font-family:Microsoft JhengHei;
      font-weight:bold;
      width:"100%";    
      background-color:	#AAFFEE;
  }   
  a{
    color:black; 
    text-decoration:none;
  } 
  .status{
    float:right;
    
  }
  table  {
      font-size: 30px;
      border: none ;
      text-align:center;
      font-family:Microsoft JhengHei;
      font-weight:bold;
  }
  #myTable{
      font-size: 20px;
  }
  html,body{
    font-family:Verdana,sans-serif;
    font-size:15px;
    line-height:1.2
  }
  @media(max-width:768px) {
  
    #myTable{
        font-size: 10px;
      }
  
    .title{
      font-size: 20px;
    } 
    table  {
      font-size: 10px;
      border: none ;
      text-align:center;
      font-family:Microsoft JhengHei;
      font-weight:bold;
    } 
    .lable {
      font-size: 10px;
      font-family:Microsoft JhengHei;
      font-weight:bold;
    }
    .lable1 {
      font-size: 15px;
      font-weight:bold;
      font-family:Microsoft JhengHei;
  
    }
  }

</style>

<script >

var firebaseConfig = {
    apiKey: "AIzaSyC1DlPU6BqCFXzWLBZ_6Y90KNLwYzfei3c",
    authDomain: "tafengtravel-web.firebaseapp.com",
    projectId: "tafengtravel-web",
    storageBucket: "tafengtravel-web.appspot.com",
    messagingSenderId: "971660802735",
    appId: "1:971660802735:web:af7e22d11fe81ca63ab25a"
  };
  // Initialize Firebase
firebase.initializeApp(firebaseConfig);

firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)

//--------------修改紀錄--------------//
let usermail;
let time;
let record;
let todaydate;
let Today=new Date();

async function search(){

  let db = firebase.firestore();
  let ref = db.collection('product')
  let ref1 = db.collection('list')

  let k=0;
  let docID;
  let docDATA = {}
  let docDATA1

  let listID;
  let listDATA = {}
  let listDATA1

  await ref1.get().then(querySnapshot => {
    querySnapshot.forEach(doc => {
      listID = doc.id;
      listDATA1 = doc.data();
      listDATA[listID] = {...listDATA1}
    });
 
    let content = JSON.stringify(listDATA);
    let blob = new Blob([content], {type: "text/plain;charset=utf-8"});
    saveAs(blob,"list.json"); 

  });

  await ref.get().then(querySnapshot => {
    querySnapshot.forEach(doc => {
      docID = doc.id;
      docDATA1 = doc.data();
      docDATA[docID] = {...docDATA1}
    });
    let content = JSON.stringify(docDATA);
    let blob = new Blob([content], {type: "text/plain;charset=utf-8"});
    saveAs(blob,"product.json"); 
  });

 
}

</script>






</body>
</html>