<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>大豐旅行社｜國內外旅遊專家</title>   	
 
  <meta name="description" content="大豐旅行社,國內旅遊,國外自由行,世界郵輪,遊覽車出租,來台旅遊">
  <meta name="keywords" content="大豐旅行社,國內旅遊,國外自由行" /> 
  <meta http-equiv="cache-control" content="no-cache">  
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="expires" content="0">
  <meta name="format-detection" content="telephone=no">
  
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
  <link rel="icon" href="https://tafengtravel.github.io/tafengtravel/index1/tafenglogo6.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="https://tafengtravel.github.io/tafengtravel/index1/tafenglogo6.ico" type="image/x-icon" />


  <style>  
  .table1 {
      font-size: 30px;
  }
  .lable {
      font-size: 25px;
      font-family:Microsoft JhengHei;
      font-weight:bold;
  }
  .lable2 {
      font-size: 20px;
      font-family:Microsoft JhengHei;
      color: 	#5B5B5B;
      font-weight:bold;
  }
  
  table  {
      font-size: 25px;
      border: none ;
      text-align:center;
      font-family:Microsoft JhengHei;
      font-weight:bold;
      table-layout:fixed;
         
  }
  
  
  .lable1 {
      font-size: 30px;
      font-weight:bold;
      font-family:Microsoft JhengHei;
  
  }
  
  .title
  {
      font-size: 60px;
      text-align: center;
      font-family:Microsoft JhengHei;
      font-weight:bold;
      width:"100%";    
      background-color:	#AAFFEE;
  }   
  a{
    color:black; 
    text-decoration:none;
  } 
  .status{
    float:right;
    
  }
  </style> 

</head>
<body>

       <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="/__/firebase/7.14.3/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<!-- Initialize Firebase -->
<script src="/__/firebase/init.js"></script>
   
   <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>

<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase-firestore.js"></script>


<div class="title"  >大豐旅行社__合約下載</div> 

<span class="lable" ><label>團號：</label></span>&ensp;&ensp;&emsp;<input type="text" id="number" style="font-size:30px ">
<br><span class="lable" ><label>代表人：</label></span> <input type="text" id="people" style="font-size:30px ">
&emsp;<button onclick="search()" id ="search"  type="button" style="font-size:30px"  >查詢</button>


<iframe id='iframe123' frameborder="0" width="100%" height="1500"></iframe>



<!--
<div class="lable1" id="id" style =  >已登入帳號：</div> 
<div class="lable1" id="id1" style =  ></div>
-->
<br><br>

<script src="secure.js" async>
</script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.0.0/jspdf.umd.min.js"></script>




<script type="text/javascript" src="datauri.js"></script>
<script src="imguri.js"></script>
<script src="imguri1.js"></script>
<script>

function info(){
    
}

</script>



<script>

function search(){

  let db = firebase.firestore();
  let number = document.getElementById("number").value; 
  let people = document.getElementById("people").value; 

  let ref = db.collection('contract').doc(number);

    ref.get().then(doc => {

    i=parseInt(doc.id);
    console.log(i);

    if (doc.data().代表人 == people){
      show(doc.data());
    }else if (doc.data() != people){
      alert('資料錯誤');
      return 0; 
    }



  });


}

function show(data){
  let people = data.代表人;
  let name = data.團名;
  let depdate = data.出發日期;
  let enddate = data.結束日期;
  let price = data.團費;
  let contractdownpay = data.定金;
  let contractother = data.合約備註;
  let pricedetail;
  let date;

  pricedetail = depdate+'~'+enddate+name+'團費共$'+price

  let Today=new Date();
  date = Today.getFullYear()+"      "+(Today.getMonth()+1)+"      "+Today.getDate();

  //--------------JSpdf-------------
  window.jsPDF = window.jspdf.jsPDF

  // Don't forget, that there are CORS-Restrictions. So if you want to run it without a Server in your Browser you need to transform the image to a dataURL
  // Use http://dataurl.net/#dataurlmaker
  window.jsPDF.API.events.push(['addFonts', function () {
  this.addFileToVFS('BiauKai-normal.ttf', res);
  this.addFont('BiauKai-normal.ttf', 'BiauKai', 'normal');
  // console.log('BiauKai-normal ok')
  }])

  var doc = new jsPDF();  

  doc.setFont('BiauKai')
  doc.addImage(img, "JPEG", 5, 5, 200, 280);
  doc.setFontSize(10);
  
  doc.text(people, 29, 47.5);      
  doc.text(depdate, 39, 143);
  doc.text(pricedetail, 12, 171);
  doc.text('定金$'+contractdownpay, 32, 190.5);

  doc.addPage();     
  doc.addImage(img1, "JPEG", 5, 5, 200, 280);
  doc.text(contractother, 113, 17);
  doc.text(date, 141, 261);
  document.getElementById('iframe123').src = doc.output('datauri');


}

 






</script>
</body>
</html>
